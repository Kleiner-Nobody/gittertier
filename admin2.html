<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitterTier Repository AI Assistant</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0d1117 0%, #161b22 100%);
            color: #c9d1d9;
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background-color: #0d1117;
            border-radius: 12px;
            border: 1px solid #30363d;
            overflow: hidden;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.5);
        }
        
        header {
            background: linear-gradient(90deg, #238636 0%, #2ea043 100%);
            padding: 25px;
            text-align: center;
            border-bottom: 1px solid #30363d;
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
            color: white;
        }
        
        .description {
            font-size: 1.1rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .chat-container {
            display: flex;
            flex-direction: column;
            height: 500px;
        }
        
        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .message {
            max-width: 80%;
            padding: 15px;
            border-radius: 12px;
            line-height: 1.5;
        }
        
        .ai-message {
            background-color: #161b22;
            border: 1px solid #30363d;
            align-self: flex-start;
            border-top-left-radius: 5px;
        }
        
        .user-message {
            background: linear-gradient(90deg, #3a88ff 0%, #5fa3ff 100%);
            color: white;
            align-self: flex-end;
            border-top-right-radius: 5px;
        }
        
        .input-area {
            display: flex;
            padding: 20px;
            border-top: 1px solid #30363d;
            background-color: #161b22;
        }
        
        input {
            flex: 1;
            padding: 15px;
            border: 1px solid #30363d;
            border-radius: 8px;
            background-color: #0d1117;
            color: #c9d1d9;
            font-size: 1rem;
        }
        
        button {
            margin-left: 10px;
            padding: 15px 25px;
            background: linear-gradient(90deg, #238636 0%, #2ea043 100%);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: transform 0.1s ease;
        }
        
        button:hover {
            transform: translateY(-2px);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        .typing-indicator {
            padding: 10px;
            color: #8b949e;
            font-style: italic;
        }
        
        .repo-info {
            display: flex;
            justify-content: center;
            gap: 20px;
            padding: 15px;
            background-color: #161b22;
            border-bottom: 1px solid #30363d;
        }
        
        .repo-stat {
            display: flex;
            align-items: center;
            gap: 5px;
            color: #8b949e;
        }
        
        .loading {
            text-align: center;
            padding: 20px;
            color: #8b949e;
        }
        
        .error {
            color: #f85149;
            padding: 10px;
            text-align: center;
        }
        
        .code-snippet {
            background-color: #161b22;
            border: 1px solid #30363d;
            border-radius: 6px;
            padding: 12px;
            margin: 10px 0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }
        
        @media (max-width: 600px) {
            .message {
                max-width: 90%;
            }
            
            .input-area {
                flex-direction: column;
            }
            
            button {
                margin: 10px 0 0 0;
            }
            
            .repo-info {
                flex-wrap: wrap;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>GitterTier Repository AI Assistant</h1>
            <p class="description">Ask me anything about the GitterTier GitHub repository</p>
        </header>
        
        <div class="repo-info">
            <div class="repo-stat">üìÇ <span id="file-count">Loading...</span> Files</div>
            <div class="repo-stat">üìù <span id="readme-status">Loading...</span> README</div>
            <div class="repo-stat">üîÑ <span id="last-updated">Loading...</span> Updated</div>
        </div>
        
        <div class="chat-container">
            <div class="chat-messages" id="chat-messages">
                <div class="message ai-message">
                    Hi there! I'm your GitterTier repository assistant. I'm currently loading the repository data from GitHub. Please wait a moment...
                </div>
            </div>
            
            <div class="input-area">
                <input type="text" id="user-input" placeholder="Ask a question about GitterTier..." autocomplete="off" disabled>
                <button id="send-btn" disabled>Send</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const chatMessages = document.getElementById('chat-messages');
            const userInput = document.getElementById('user-input');
            const sendBtn = document.getElementById('send-btn');
            const fileCountElement = document.getElementById('file-count');
            const readmeStatusElement = document.getElementById('readme-status');
            const lastUpdatedElement = document.getElementById('last-updated');
            
            let repositoryData = {};
            let fileContents = {};
            
            // Function to add a message to the chat
            function addMessage(text, isUser = false) {
                const messageDiv = document.createElement('div');
                messageDiv.classList.add('message');
                messageDiv.classList.add(isUser ? 'user-message' : 'ai-message');
                
                // Check if the text contains code snippets and format them
                if (text.includes('```')) {
                    const parts = text.split('```');
                    for (let i = 0; i < parts.length; i++) {
                        if (i % 2 === 0) {
                            // Regular text
                            const textPart = document.createTextNode(parts[i]);
                            messageDiv.appendChild(textPart);
                        } else {
                            // Code snippet
                            const codeSnippet = document.createElement('pre');
                            codeSnippet.classList.add('code-snippet');
                            codeSnippet.textContent = parts[i];
                            messageDiv.appendChild(codeSnippet);
                        }
                    }
                } else {
                    messageDiv.textContent = text;
                }
                
                chatMessages.appendChild(messageDiv);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
            
            // Function to simulate typing indicator
            function showTypingIndicator() {
                const typingDiv = document.createElement('div');
                typingDiv.classList.add('typing-indicator');
                typingDiv.id = 'typing-indicator';
                typingDiv.textContent = 'AI is thinking...';
                chatMessages.appendChild(typingDiv);
                chatMessages.scrollTop = chatMessages.scrollHeight;
                
                return typingDiv;
            }
            
            // Function to fetch repository data from GitHub API
            async function fetchRepositoryData() {
                try {
                    addMessage("Fetching repository information from GitHub...");
                    
                    // Fetch repository info
                    const repoResponse = await fetch('https://api.github.com/repos/Kleiner-Nobody/gittertier');
                    if (!repoResponse.ok) throw new Error('Failed to fetch repository info');
                    const repoData = await repoResponse.json();
                    
                    repositoryData = repoData;
                    
                    // Update repo info stats
                    fileCountElement.textContent = repoData.size || 'N/A';
                    lastUpdatedElement.textContent = new Date(repoData.updated_at).toLocaleDateString();
                    
                    // Fetch repository contents
                    const contentsResponse = await fetch('https://api.github.com/repos/Kleiner-Nobody/gittertier/contents');
                    if (!contentsResponse.ok) throw new Error('Failed to fetch repository contents');
                    const contentsData = await contentsResponse.json();
                    
                    // Check if README exists
                    const readmeFile = contentsData.find(file => file.name.toLowerCase().includes('readme'));
                    readmeStatusElement.textContent = readmeFile ? 'Available' : 'Not found';
                    
                    // Fetch README content if available
                    if (readmeFile) {
                        const readmeResponse = await fetch(readmeFile.download_url);
                        if (readmeResponse.ok) {
                            fileContents['README'] = await readmeResponse.text();
                        }
                    }
                    
                    // Fetch additional important files (package.json, LICENSE, etc.)
                    const importantFiles = contentsData.filter(file => 
                        file.name === 'package.json' || 
                        file.name === 'LICENSE' || 
                        file.name === 'index.html' ||
                        file.name.endsWith('.md')
                    );
                    
                    for (const file of importantFiles) {
                        try {
                            const fileResponse = await fetch(file.download_url);
                            if (fileResponse.ok) {
                                fileContents[file.name] = await fileResponse.text();
                            }
                        } catch (error) {
                            console.error(`Error fetching ${file.name}:`, error);
                        }
                    }
                    
                    addMessage("Repository data loaded successfully! You can now ask questions about GitterTier.");
                    userInput.disabled = false;
                    sendBtn.disabled = false;
                    userInput.placeholder = "Ask a question about GitterTier...";
                    
                } catch (error) {
                    console.error('Error fetching repository data:', error);
                    addMessage("Sorry, I encountered an error while fetching the repository data. Please try again later.", false);
                    addMessage(`Error details: ${error.message}`, false);
                }
            }
            
            // Function to process user question and generate response
            function processQuestion(question) {
                question = question.toLowerCase();
                
                // Check for specific question patterns and provide answers based on repository data
                if (question.includes('what is') || question.includes('gittertier')) {
                    if (fileContents['README']) {
                        // Extract the description from README
                        const descriptionMatch = fileContents['README'].match(/#.*\n+([^#]*)/);
                        if (descriptionMatch && descriptionMatch[1]) {
                            return `GitterTier is: ${descriptionMatch[1].trim()}`;
                        }
                    }
                    return "GitterTier appears to be a GitHub repository. I couldn't fetch a detailed description, but you can check the repository directly at https://github.com/Kleiner-Nobody/gittertier";
                
                } else if (question.includes('license') || question.includes('licence')) {
                    if (fileContents['LICENSE']) {
                        return `The repository is licensed under:\n\`\`\`\n${fileContents['LICENSE']}\n\`\`\``;
                    }
                    return "I couldn't find the license information. Please check the repository directly.";
                
                } else if (question.includes('package.json') || question.includes('dependencies')) {
                    if (fileContents['package.json']) {
                        try {
                            const packageInfo = JSON.parse(fileContents['package.json']);
                            let response = `Project: ${packageInfo.name || 'N/A'}\n`;
                            response += `Description: ${packageInfo.description || 'N/A'}\n`;
                            response += `Version: ${packageInfo.version || 'N/A'}\n`;
                            
                            if (packageInfo.dependencies) {
                                response += `Dependencies: ${Object.keys(packageInfo.dependencies).join(', ')}`;
                            }
                            
                            return response;
                        } catch (e) {
                            return "I found package.json but couldn't parse it correctly.";
                        }
                    }
                    return "I couldn't find the package.json file.";
                
                } else if (question.includes('readme') || question.includes('documentation')) {
                    if (fileContents['README']) {
                        // Return first 500 characters of README
                        return `Here's part of the README:\n\n${fileContents['README'].substring(0, 500)}...`;
                    }
                    return "I couldn't find the README file.";
                
                } else if (question.includes('how to run') || question.includes('how to use') || question.includes('install')) {
                    if (fileContents['README']) {
                        // Look for installation or usage instructions in README
                        const usageMatch = fileContents['README'].match(/(##.*(Installation|Usage|How to).*?##)(.*?)(?:##|$)/si);
                        if (usageMatch && usageMatch[3]) {
                            return `Here are the instructions:\n\n${usageMatch[3].trim()}`;
                        }
                    }
                    return "Check the README.md file for installation and usage instructions.";
                
                } else {
                    // Generic response for other questions
                    return "I've fetched the repository data, but I'm not sure how to answer that specific question. You can ask about what GitterTier is, its license, dependencies, or how to use it. The repository contains " + 
                           Object.keys(fileContents).join(', ') + " among other files.";
                }
            }
            
            // Function to handle user input
            function handleUserInput() {
                const question = userInput.value.trim();
                if (question === '') return;
                
                // Add user message to chat
                addMessage(question, true);
                
                // Clear input
                userInput.value = '';
                
                // Show typing indicator
                const typingIndicator = showTypingIndicator();
                
                // Process question and generate response with a slight delay
                setTimeout(() => {
                    // Remove typing indicator
                    typingIndicator.remove();
                    
                    // Process question and generate response
                    const response = processQuestion(question);
                    
                    // Add AI response to chat
                    addMessage(response);
                }, 1500);
            }
            
            // Event listeners
            sendBtn.addEventListener('click', handleUserInput);
            
            userInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    handleUserInput();
                }
            });
            
            // Initialize by fetching repository data
            fetchRepositoryData();
        });
    </script>
</body>
</html>