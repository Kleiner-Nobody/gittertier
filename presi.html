<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Die Geschichte des Gittertiers - Eine tierisch gute Präsentation</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pptxgenjs/3.11.0/pptxgen.bundle.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #1a2a6c);
            color: #333;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            overflow: hidden;
        }

        .presentation-container {
            width: 100%;
            max-width: 1200px;
            height: 0;
            padding-bottom: 56.25%; /* 16:9 Aspect Ratio */
            position: relative;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
            overflow: hidden;
            transition: all 0.5s ease;
        }

        body.fullscreen .presentation-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            max-width: none;
            padding-bottom: 0;
            border-radius: 0;
            z-index: 1000;
        }

        .slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            padding: 40px;
            display: none;
            opacity: 0;
            transition: opacity 0.8s ease;
            background-size: cover;
            background-position: center;
            overflow: hidden;
        }

        .slide.active {
            display: block;
            opacity: 1;
            animation: slideIn 0.8s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .slide-header {
            background: rgba(0, 86, 179, 0.85);
            color: white;
            padding: 25px 40px;
            border-radius: 0 0 20px 20px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            transform: translateY(-100%);
            animation: headerSlideIn 0.8s forwards 0.3s;
        }

        @keyframes headerSlideIn {
            to { transform: translateY(0); }
        }

        .slide-title {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .slide-subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .slide-content {
            display: flex;
            gap: 40px;
            height: calc(100% - 150px);
        }

        .text-content {
            flex: 1;
            padding: 20px;
            background: rgba(255, 255, 255, 0.85);
            border-radius: 15px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
            overflow-y: auto;
            transform: translateX(-50px);
            opacity: 0;
            animation: contentAppear 0.8s forwards 0.6s;
        }

        @keyframes contentAppear {
            to { transform: translateX(0); opacity: 1; }
        }

        .text-content p {
            line-height: 1.8;
            margin-bottom: 20px;
            font-size: 1.1rem;
            position: relative;
        }

        .text-content ul {
            margin: 20px 0;
            padding-left: 30px;
        }

        .text-content ul li {
            margin-bottom: 10px;
            line-height: 1.6;
            position: relative;
            padding-left: 25px;
        }

        .text-content ul li:before {
            content: "•";
            color: #0056b3;
            font-weight: bold;
            position: absolute;
            left: 0;
            font-size: 1.5rem;
        }

        .image-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transform: translateX(50px);
            opacity: 0;
            animation: contentAppear 0.8s forwards 0.9s;
        }

        .image-content img {
            max-width: 100%;
            max-height: 300px;
            border-radius: 15px;
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.3);
            margin-bottom: 20px;
            border: 5px solid white;
            object-fit: cover;
            animation: float 6s infinite ease-in-out;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        .image-caption {
            font-style: italic;
            color: #fff;
            text-align: center;
            font-size: 1rem;
            background: rgba(0, 0, 0, 0.6);
            padding: 8px 15px;
            border-radius: 20px;
            width: 100%;
        }

        .humor-note {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
            font-style: italic;
            position: relative;
            overflow: hidden;
        }

        .humor-note i {
            color: #ffc107;
            margin-right: 8px;
            font-size: 1.2rem;
        }

        .controls {
            position: absolute;
            bottom: 30px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: center;
            gap: 20px;
            z-index: 10;
        }

        .nav-btn {
            padding: 12px 30px;
            background: #0056b3;
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        .nav-btn:hover {
            background: #003d82;
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
        }

        .nav-btn:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .fullscreen-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.3);
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 100;
            font-size: 1.2rem;
            transition: all 0.3s ease;
        }

        .fullscreen-btn:hover {
            background: rgba(0, 86, 179, 0.8);
            transform: scale(1.1);
        }

        .progress-container {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 8px;
            background: rgba(0, 0, 0, 0.1);
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #ff6b6b, #0056b3);
            width: 0%;
            transition: width 0.5s ease;
        }

        .slide-counter {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(0, 86, 179, 0.8);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            z-index: 10;
        }

        .download-container {
            position: absolute;
            top: 20px;
            right: 80px;
        }

        .download-btn {
            padding: 12px 25px;
            background: linear-gradient(to right, #28a745, #218838);
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        .download-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
            background: linear-gradient(to right, #218838, #1e7e34);
        }

        .loading {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.85);
            color: white;
            padding: 30px 50px;
            border-radius: 15px;
            text-align: center;
            z-index: 2000;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.5);
        }

        .loading i {
            font-size: 3rem;
            margin-bottom: 20px;
            display: block;
            animation: spin 2s infinite linear;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @media (max-width: 900px) {
            .slide-content {
                flex-direction: column;
                height: calc(100% - 180px);
            }
            
            .text-content, .image-content {
                flex: none;
                width: 100%;
                height: auto;
            }
            
            .image-content {
                margin-top: 20px;
            }
            
            .slide-title {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="presentation-container">
        <!-- Fullscreen Button -->
        <button class="fullscreen-btn" id="fullscreen-btn">
            <i class="fas fa-expand"></i>
        </button>
        
        <!-- Download Button -->
        <div class="download-container">
            <button class="download-btn" id="download-pptx">
                <i class="fas fa-download"></i> PPTX
            </button>
        </div>
        
        <!-- Slide 1: Einführung -->
        <div class="slide active" id="slide1" style="background: linear-gradient(rgba(255,255,255,0.9), rgba(255,255,255,0.7)), url('https://images.unsplash.com/photo-1607082348824-0a96f2a4b9da?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1740&q=80'); background-size: cover;">
            <div class="slide-header">
                <h1 class="slide-title"><i class="fas fa-shopping-cart"></i> Die Geschichte des Gittertiers</h1>
                <p class="slide-subtitle">Eine wissenschaftliche Betrachtung der Evolution des Einkaufswagens</p>
            </div>
            
            <div class="slide-content">
                <div class="text-content">
                    <p>Willkommen zur faszinierenden Geschichte des "Gittertiers" - wie der Einkaufswagen in Internetkreisen liebevoll genannt wird. Diese Präsentation zeigt die evolutionäre Entwicklung eines der einflussreichsten Objekte des modernen Handels.</p>
                    
                    <div class="humor-note">
                        <i class="fas fa-lightbulb"></i> <strong>Gittertier-Witz:</strong> Warum sind Gittertiere schlechte Geheimagenten? Weil sie immer Spuren hinterlassen!
                    </div>
                    
                    <p>Was Sie erwartet:</p>
                    <ul>
                        <li>Die Domestizierung des Gittertiers in den 1930ern</li>
                        <li>Evolutionäre Anpassungen und Design-Verbesserungen</li>
                        <li>Die Ausbreitung in verschiedenen Kulturen</li>
                        <li>Moderne Unterarten und ihre Besonderheiten</li>
                        <li>Kulturelle Bedeutung und Kuriositäten</li>
                    </ul>
                    
                    <p>Diese Präsentation ist im 16:9-Format optimiert und kann durch Klicken auf den Vollbild-Button (<i class="fas fa-expand"></i>) oben rechts im Vollbildmodus betrachtet werden.</p>
                </div>
                
                <div class="image-content">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/1/1d/Shopping_cart_invented_by_Sylvan_Goldman.jpg" alt="Erster Einkaufswagen">
                    <p class="image-caption">Das Ur-Gittertier: Erster Einkaufswagen von Sylvan Goldman (1937)</p>
                </div>
            </div>
            
            <div class="slide-counter">Folie 1 von 6</div>
        </div>
        
        <!-- Slide 2: Die Erfindung -->
        <div class="slide" id="slide2" style="background: linear-gradient(rgba(255,255,255,0.9), rgba(255,255,255,0.7)), url('https://images.unsplash.com/photo-1607082348824-0a96f2a4b9da?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1740&q=80'); background-size: cover;">
            <div class="slide-header">
                <h1 class="slide-title"><i class="fas fa-lightbulb"></i> 1937: Die Geburtsstunde des Gittertiers</h1>
                <p class="slide-subtitle">Wie der Einkaufswagen den Handel revolutionierte</p>
            </div>
            
            <div class="slide-content">
                <div class="text-content">
                    <p>1937 erfand Sylvan Goldman, ein Supermarktbesitzer aus Oklahoma City, das erste domestizierte Gittertier. Seine Beobachtung: Kunden beendeten ihren Einkauf, sobald ihre Körbe voll waren.</p>
                    
                    <div class="humor-note">
                        <i class="fas fa-paw"></i> <strong>Gittertier-Funfact:</strong> Die ersten Gittertiere wurden von Menschen skeptisch beäugt. Männer fanden sie "unmännlich", Frauen verglichen sie mit Kinderwagen.
                    </div>
                    
                    <p>Goldmans revolutionäre Erfindung:</p>
                    <ul>
                        <li>Inspiriert von einem Holzklappstuhl</li>
                        <li>Einfaches Gestell mit Rädern und zwei Körben</li>
                        <li>Erhöhung der durchschnittlichen Einkaufsmenge um 300%</li>
                        <li>Marketing-Strategie: Angestellte als "normale Kunden" mit Wagen</li>
                    </ul>
                    
                    <p>Die Erfindung des Einkaufswagens markiert den Beginn der Selbstbedienungskultur im Einzelhandel und veränderte das Einkaufsverhalten nachhaltig.</p>
                </div>
                
                <div class="image-content">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/3/37/A_typical_small_general_store_in_rural_Ohio%2C_USA%2C_in_the_late_1930s_%2820%29.jpg" alt="Supermarkt in den 1930ern">
                    <p class="image-caption">Supermarkt in den späten 1930ern - noch ohne Gittertiere</p>
                </div>
            </div>
            
            <div class="slide-counter">Folie 2 von 6</div>
        </div>
        
        <!-- Slide 3: Design-Verbesserungen -->
        <div class="slide" id="slide3" style="background: linear-gradient(rgba(255,255,255,0.9), rgba(255,255,255,0.7)), url('https://images.unsplash.com/photo-1607082348824-0a96f2a4b9da?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1740&q=80'); background-size: cover;">
            <div class="slide-header">
                <h1 class="slide-title"><i class="fas fa-drafting-compass"></i> 1950er: Evolution des Designs</h1>
                <p class="slide-subtitle">Vom einfachen Wagen zum multifunktionalen Begleiter</p>
            </div>
            
            <div class="slide-content">
                <div class="text-content">
                    <p>In den 1950er Jahren erlebte das Gittertier eine bemerkenswerte evolutionäre Entwicklung. Die wichtigsten Verbesserungen:</p>
                    
                    <ul>
                        <li><strong>Kindersitze:</strong> Ermöglichten Eltern, Kinder während des Einkaufs sicher unterzubringen</li>
                        <li><strong>Lenkrollen:</strong> Verbesserte Manövrierfähigkeit in engen Gängen</li>
                        <li><strong>Telescoping System:</strong> Effizientes Stapeln durch Orla Watson (1946)</li>
                        <li><strong>Kippsicherheit:</strong> Tiefere Körbe verhinderten das Umkippen</li>
                    </ul>
                    
                    <div class="humor-note">
                        <i class="fas fa-shopping-cart"></i> <strong>Gittertier-Witz:</strong> Warum sind Gittertiere gute Tänzer? Weil sie vier Räder haben und sich gut drehen können!
                    </div>
                    
                    <p>Diese Verbesserungen machten den Einkaufswagen zum unverzichtbaren Begleiter im Supermarkt und erhöhten die durchschnittliche Einkaufsmenge deutlich. Das Gittertier hatte sich endgültig in der menschlichen Kultur etabliert.</p>
                </div>
                
                <div class="image-content">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/1/19/Shopping_cart_nesting.jpg" alt="Einkaufswagen-Stapelung">
                    <p class="image-caption">Das effiziente Nesting-System für Gittertier-Haltung</p>
                </div>
            </div>
            
            <div class="slide-counter">Folie 3 von 6</div>
        </div>
        
        <!-- Slide 4: Material und Technologie -->
        <div class="slide" id="slide4" style="background: linear-gradient(rgba(255,255,255,0.9), rgba(255,255,255,0.7)), url('https://images.unsplash.com/photo-1607082348824-0a96f2a4b9da?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1740&q=80'); background-size: cover;">
            <div class="slide-header">
                <h1 class="slide-title"><i class="fas fa-cogs"></i> 1960er: Materialwechsel und Technologie</h1>
                <p class="slide-subtitle">Vom schweren Metall zum leichten High-Tech-Design</p>
            </div>
            
            <div class="slide-content">
                <div class="text-content">
                    <p>Die 1960er brachten revolutionäre Veränderungen in der Materialverwendung und Technologie des Gittertiers:</p>
                    
                    <ul>
                        <li><strong>Materialwechsel:</strong> Von schwerem Metall zu leichteren Stahlrohren und Kunststoffkomponenten</li>
                        <li><strong>Münzsystem:</strong> Eingeführt in Europa zur Diebstahlprävention</li>
                        <li><strong>Standardisierung:</strong> Einheitliche Maße für effizientes Stapeln</li>
                        <li><strong>Barrierefreiheit:</strong> Spezielle Wagen für Menschen mit Behinderungen</li>
                    </ul>
                    
                    <div class="humor-note">
                        <i class="fas fa-coins"></i> <strong>Gittertier-Ökonomie:</strong> Das Münzsystem war eine geniale Lösung - es machte den Diebstahl unattraktiv und sorgte dafür, dass die Gittertiere immer zurückgebracht wurden!
                    </div>
                    
                    <p>Gegen Ende der 1960er Jahre wurden die ersten elektronischen Systeme entwickelt, die später zu den "intelligenten" Gittertieren führen sollten. Diese Entwicklung setzt sich bis heute fort.</p>
                </div>
                
                <div class="image-content">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/0/0d/Supermarkt_einkaufswagen.jpg" alt="Moderner Einkaufswagen">
                    <p class="image-caption">Moderne Gittertier-Variante mit Kunststoffelementen</p>
                </div>
            </div>
            
            <div class="slide-counter">Folie 4 von 6</div>
        </div>
        
        <!-- Slide 5: Moderne Varianten -->
        <div class="slide" id="slide5" style="background: linear-gradient(rgba(255,255,255,0.9), rgba(255,255,255,0.7)), url('https://images.unsplash.com/photo-1607082348824-0a96f2a4b9da?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1740&q=80'); background-size: cover;">
            <div class="slide-header">
                <h1 class="slide-title"><i class="fas fa-sync-alt"></i> Moderne Gittertier-Varianten</h1>
                <p class="slide-subtitle">Die Evolution geht weiter - vom Smart Cart zum autonomen Wagen</p>
            </div>
            
            <div class="slide-content">
                <div class="text-content">
                    <p>Heute existiert eine beeindruckende Vielfalt an Gittertier-Unterarten, die spezifische Bedürfnisse erfüllen:</p>
                    
                    <ul>
                        <li><strong>Kinderwagen:</strong> Mit Spielzeug und bequemen Sitzen für kleine Einkäufer</li>
                        <li><strong>Familienwagen:</strong> Mit Platz für zwei oder mehr Kinder</li>
                        <li><strong>Smart Carts:</strong> Mit integriertem Scanner und Bezahlfunktion</li>
                        <li><strong>Barrierefreie Wagen:</strong> Für Menschen mit eingeschränkter Mobilität</li>
                        <li><strong>Mini-Wagen:</strong> Für kleine Einkäufe oder Kinder</li>
                    </ul>
                    
                    <div class="humor-note">
                        <i class="fas fa-robot"></i> <strong>Zukunftsprognose:</strong> Die nächste Evolutionsstufe sind autonome Gittertiere, die selbstständig Kunden folgen und sogar die Ware nach Hause bringen!
                    </div>
                    
                    <p>Die Entwicklung geht weiter - mit GPS-Tracking, integrierten Tablets für Einkaufslisten und sogar Kühlfächern für Tiefkühlware. Das Gittertier bleibt ein faszinierendes Beispiel für die Ko-Evolution von Mensch und Technologie.</p>
                </div>
                
                <div class="image-content">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/5/5e/Self-Scanning_Shopping_Trolley_-_geograph.org.uk_-_1818801.jpg" alt="Smart Einkaufswagen">
                    <p class="image-caption">Smart Cart mit integriertem Scanner und Display</p>
                </div>
            </div>
            
            <div class="slide-counter">Folie 5 von 6</div>
        </div>
        
        <!-- Slide 6: Kultur und Bedeutung -->
        <div class="slide" id="slide6" style="background: linear-gradient(rgba(255,255,255,0.9), rgba(255,255,255,0.7)), url('https://images.unsplash.com/photo-1607082348824-0a96f2a4b9da?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1740&q=80'); background-size: cover;">
            <div class="slide-header">
                <h1 class="slide-title"><i class="fas fa-globe"></i> Kultur & Kuriositäten</h1>
                <p class="slide-subtitle">Vom Umweltproblem zum Internet-Phänomen</p>
            </div>
            
            <div class="slide-content">
                <div class="text-content">
                    <p>Das Gittertier hat nicht nur den Handel revolutioniert, sondern auch Eingang in die Kultur gefunden:</p>
                    
                    <ul>
                        <li><strong>Kunst:</strong> Banksy und andere Künstler nutzen Einkaufswagen in ihren Werken</li>
                        <li><strong>Internet-Phänomen:</strong> "Gittertier" als humorvolle Bezeichnung in sozialen Medien</li>
                        <li><strong>Psychologie:</strong> Der "Einkaufswagen-Test" als moralisches Dilemma</li>
                        <li><strong>Sport:</strong> "Shopping Cart Racing" als ungewöhnlicher Wettbewerb</li>
                        <li><strong>Ökologie:</strong> Wilde Gittertiere in Flüssen als Umweltproblem</li>
                    </ul>
                    
                    <div class="humor-note">
                        <i class="fas fa-theater-masks"></i> <strong>Gittertier-Mythos:</strong> In Internetforen wird scherzhaft behauptet, Einkaufswagen seien eine eigene Tierart ("Cartus metallicus"), die in freier Wildbahn beobachtet werden kann.
                    </div>
                    
                    <p>Weltweit gibt es bemerkenswerte Initiativen: In den Niederlanden schwimmende Supermärkte, in Japan High-Tech-Wagen mit Navigationssystem, und in Schweden Einkaufswagen mit integriertem Kühlfach.</p>
                </div>
                
                <div class="image-content">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/3/31/Supermarket_cart_pool.jpg" alt="Einkaufswagen im See">
                    <p class="image-caption">"Wilde" Gittertiere in ihrem natürlichen Habitat</p>
                </div>
            </div>
            
            <div class="slide-counter">Folie 6 von 6</div>
        </div>
        
        <!-- Progress Bar -->
        <div class="progress-container">
            <div class="progress-bar" id="progress-bar"></div>
        </div>
        
        <!-- Navigation Controls -->
        <div class="controls">
            <button class="nav-btn" id="prev-btn">
                <i class="fas fa-arrow-left"></i> Zurück
            </button>
            <button class="nav-btn" id="next-btn">
                Weiter <i class="fas fa-arrow-right"></i>
            </button>
        </div>
    </div>
    
    <!-- Loading Indicator -->
    <div class="loading" id="loading">
        <i class="fas fa-spinner"></i>
        <h3>Erstelle PowerPoint-Präsentation...</h3>
        <p>Bitte haben Sie einen Moment Geduld</p>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const slides = document.querySelectorAll('.slide');
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            const progressBar = document.getElementById('progress-bar');
            const fullscreenBtn = document.getElementById('fullscreen-btn');
            const downloadBtn = document.getElementById('download-pptx');
            const loading = document.getElementById('loading');
            let currentSlide = 0;
            
            // Update progress bar
            function updateProgress() {
                const progressPercentage = ((currentSlide + 1) / slides.length) * 100;
                progressBar.style.width = `${progressPercentage}%`;
                
                // Update slide counters
                document.querySelectorAll('.slide-counter').forEach((counter, index) => {
                    counter.textContent = `Folie ${index + 1} von ${slides.length}`;
                });
            }
            
            // Show slide
            function showSlide(index) {
                slides.forEach(slide => slide.classList.remove('active'));
                slides[index].classList.add('active');
                
                prevBtn.disabled = index === 0;
                nextBtn.disabled = index === slides.length - 1;
                
                currentSlide = index;
                updateProgress();
            }
            
            // Navigation
            nextBtn.addEventListener('click', () => {
                if (currentSlide < slides.length - 1) {
                    showSlide(currentSlide + 1);
                }
            });
            
            prevBtn.addEventListener('click', () => {
                if (currentSlide > 0) {
                    showSlide(currentSlide - 1);
                }
            });
            
            // Fullscreen functionality
            fullscreenBtn.addEventListener('click', () => {
                if (!document.fullscreenElement) {
                    document.documentElement.requestFullscreen().catch(err => {
                        console.error(`Error attempting to enable fullscreen: ${err.message}`);
                    });
                    document.body.classList.add('fullscreen');
                    fullscreenBtn.innerHTML = '<i class="fas fa-compress"></i>';
                } else {
                    if (document.exitFullscreen) {
                        document.exitFullscreen();
                        document.body.classList.remove('fullscreen');
                        fullscreenBtn.innerHTML = '<i class="fas fa-expand"></i>';
                    }
                }
            });
            
            // Download PPTX functionality
            downloadBtn.addEventListener('click', async () => {
                loading.style.display = 'block';
                
                try {
                    // Create presentation
                    const pptx = new pptxgen();
                    
                    // Set presentation properties
                    pptx.title = "Die Geschichte des Gittertiers";
                    pptx.author = "Gittertier-Forschungsinstitut";
                    pptx.company = "Einkaufswagen Historische Gesellschaft";
                    
                    // Layout for 16:9
                    pptx.layout = "LAYOUT_WIDE";
                    
                    // Add slides
                    for (let i = 0; i < slides.length; i++) {
                        const slide = pptx.addSlide();
                        
                        // Get slide title
                        const title = slides[i].querySelector('.slide-title').textContent;
                        
                        // Get slide content
                        const content = slides[i].querySelector('.text-content').textContent;
                        
                        // Get image if exists
                        const img = slides[i].querySelector('.image-content img');
                        
                        // Add title
                        slide.addText(title, {
                            x: 0.5,
                            y: 0.3,
                            w: 9,
                            fontSize: 24,
                            bold: true,
                            color: "0056b3"
                        });
                        
                        // Add content
                        slide.addText(content, {
                            x: 0.5,
                            y: 1.5,
                            w: img ? 5 : 9,
                            h: 4.5,
                            fontSize: 14
                        });
                        
                        // Add image if exists
                        if (img) {
                            slide.addImage({
                                data: img.src,
                                x: 6.0,
                                y: 1.5,
                                w: 3.5,
                                h: 3.5
                            });
                            
                            const caption = slides[i].querySelector('.image-caption').textContent;
                            slide.addText(caption, {
                                x: 6.0,
                                y: 5.1,
                                w: 3.5,
                                h: 0.5,
                                fontSize: 10,
                                italic: true,
                                color: "666666"
                            });
                        }
                        
                        // Add footer
                        slide.addText(`Folie ${i+1} von ${slides.length} - Die Geschichte des Gittertiers`, {
                            x: 0.5,
                            y: 6.8,
                            w: 9,
                            h: 0.4,
                            fontSize: 10,
                            color: "888888"
                        });
                    }
                    
                    // Download the presentation
                    pptx.writeFile({ fileName: "Gittertier-Geschichte.pptx" });
                } catch (error) {
                    alert("Fehler beim Erstellen der PPTX: " + error.message);
                    console.error(error);
                } finally {
                    loading.style.display = 'none';
                }
            });
            
            // Keyboard navigation
            document.addEventListener('keydown', (e) => {
                if (e.key === 'ArrowRight' || e.key === 'PageDown') {
                    if (currentSlide < slides.length - 1) {
                        showSlide(currentSlide + 1);
                    }
                } else if (e.key === 'ArrowLeft' || e.key === 'PageUp') {
                    if (currentSlide > 0) {
                        showSlide(currentSlide - 1);
                    }
                } else if (e.key === 'f' || e.key === 'F') {
                    fullscreenBtn.click();
                }
            });
            
            // Initialize
            showSlide(0);
            updateProgress();
        });
    </script>
</body>
</html>